---
import { getCollection } from 'astro:content';
import BaseLayout from '../../../layouts/BaseLayout.astro';
import PostCard from '../../../components/PostCard.astro';
import { breadcrumbJsonLd } from '../../../lib/seo';

const posts = (await getCollection('blog'))
  .filter((post) => post.data.lang === 'en')
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

const tags = Array.from(new Set(posts.flatMap((post) => post.data.tags))).sort();

const structuredData = [
  breadcrumbJsonLd([{ name: 'Blog', path: '/en/blog' }])
];
---

<BaseLayout
  lang="en"
  title="Technical blog | SEO, accessibility, automation"
  description="Technical articles on SEO, accessibility, performance, and measurement/automation with reproducible criteria."
  canonicalPath="/en/blog"
  alternates={[{ lang: 'es', path: '/blog' }]}
  structuredData={structuredData}
>
  <section class="section-shell mx-auto max-w-6xl px-4 py-12 md:px-6">
    <p class="text-xs uppercase tracking-[0.2em] text-accent">Blog</p>
    <h1 class="mt-2 text-3xl font-semibold text-foreground">Technical guides and applicable patterns</h1>
    <p class="mt-3 max-w-3xl text-muted">
      Repeatable processes for teams that need performance, accessibility, technical SEO, and measurement without losing traceability.
    </p>
    <p class="mt-3 text-sm text-foreground/85">Guide = applicable steps. Checklist = quick validation. Pattern = synthesized real case.</p>
    <div class="mt-4 flex flex-wrap gap-2">
      {tags.map((tag) => (
        <span class="rounded-full border border-border/70 bg-panel px-3 py-1 text-xs text-foreground/80">{tag}</span>
      ))}
    </div>
    <div class="section-divider"></div>
    <div class="grid gap-4 md:grid-cols-3">
      {posts.map((post) => (
        <PostCard post={post} />
      ))}
    </div>
  </section>
</BaseLayout>
